-- $Source: /cvsroot/tack/Ack/plat/linux386/pmfile,v $
-- $State: Exp $
-- $Revision: 1.3 $

local d = ROOTDIR.."plat/linuxppc/"

include (d.."libsys/pmfile")
include "plat/linux/liblinux/pmfile"

local bootsector = ackfile {
	file (d.."boot.s"),
	install = pm.install("%BINDIR%lib/%PLATFORM%/boot.o"),
}

local descr = group {
	install = pm.install(d.."descr", "%BINDIR%%PLATIND%/%PLATFORM%/descr")
}

local headers = group {
	install = {
		pm.install(d.."include/ack/config.h", "%BINDIR%%PLATIND%/%PLATFORM%/include/ack/config.h"),
		pm.install(d.."include/unistd.h",     "%BINDIR%%PLATIND%/%PLATFORM%/include/unistd.h"),
	}
}

platform_linuxppc = group {
	ARCH = "powerpc",
	PLATFORM = "linuxppc",
	OPTIMISATION = "-O",
	
	-- Ensure the descr and headers are installed first because we'll need it
	-- to build the libraries.
	
	descr,
	headers,
	
	-- Build the back-end support.
	
	mach_powerpc,
	support_powerpc,
	lang_runtimes,

	-- Build the PC standalone syscall library.
	
	liblinux,
	libsys_linuxppc,
	bootsector,
}
